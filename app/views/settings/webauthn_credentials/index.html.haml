- content_for :page_title do
  = 'Web Authentication'

- if current_user.webauthn_required_for_login?
  %p.hint
    %span.positive-hint
      = fa_icon 'check'
      = ' '
      = 'WebAuthn is enabled'

  %hr.spacer/

  .table-wrapper
    %table.table
      %thead
        %tr
          %th= 'Nickname'
          %th= 'Last used'
      %tbody
        - @webauthn_credentials.each do |credential|
          %tr
            %td= credential.nickname
            %td= credential.last_used_on ? l(credential.last_used_on) : 'Never'

- else
  %p.hint= 'If you enable webauthn, logging in will require you to use one of your security keys.'

%hr.spacer/

#webauthn_form{ data: { props: "{ \"optionsUrl\":\"#{api_webauthn_registration_options_path}\", \"callbackUrl\": \"#{api_webauthn_registration_path}\" }" } }
= javascript_pack_tag 'webauthn_form', integrity: true, crossorigin: 'anonymous'
